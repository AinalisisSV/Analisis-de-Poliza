<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Analizador de Pólizas con IA</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    body { font-family: system-ui, -apple-system, sans-serif; margin: 0; background: #f4f4f6; }
    header { padding: 16px 24px; background: #111827; color: #f9fafb; font-size: 18px; font-weight: 600; }
    .container { max-width: 900px; margin: 24px auto; padding: 16px; background: #ffffff; border-radius: 16px; box-shadow: 0 4px 10px rgba(0,0,0,0.06); }
    .section-title { font-size: 14px; font-weight: 600; margin-bottom: 6px; color: #111827; }
    .subtitle { color: #6b7280; font-size: 12px; margin-bottom: 12px; }
    #uploader { margin-bottom: 16px; padding: 12px; border-radius: 12px; background: #f9fafb; border: 1px solid #e5e7eb; }
    input[type="file"] { font-size: 12px; margin-bottom: 6px; }
    button { padding: 6px 14px; border-radius: 8px; border: none; cursor: pointer; font-size: 12px; font-weight: 500; background: #111827; color: #f9fafb; }
    button:disabled { opacity: 0.5; cursor: not-allowed; }
    #uploadStatus { margin-top: 4px; font-size: 11px; color: #059669; }
    #uploadError { margin-top: 4px; font-size: 11px; color: #b91c1c; }
    #chatWrapper { margin-top: 12px; }
    #chat { max-height: 320px; overflow-y: auto; padding: 8px 0; border-top: 1px solid #e5e7eb; border-bottom: 1px solid #e5e7eb; margin-bottom: 8px; display: flex; flex-direction: column; gap: 6px; }
    .msg { padding: 6px 8px; border-radius: 8px; font-size: 12px; line-height: 1.5; max-width: 90%; }
    .user { background: #dbeafe; align-self: flex-end; }
    .bot { background: #f3f4f6; align-self: flex-start; }
    .row { display: flex; gap: 6px; }
    textarea { flex: 1; resize: none; padding: 6px 8px; border-radius: 8px; border: 1px solid #d1d5db; font-size: 12px; }
    #noPolicy { font-size: 11px; color: #b91c1c; margin-bottom: 4px; display: none; }
  </style>
</head>
<body>
<header>Analizador de Pólizas con IA</header>

<div class="container">
  <div id="uploader">
    <div class="section-title">1. Subí tu póliza</div>
    <div class="subtitle">
      Subí tu póliza para que el asistente responda solo con base en ese documento. (Demo visual)
    </div>
    <input type="file" id="fileInput" accept=".pdf,.doc,.docx,.jpg,.jpeg,.png" />
    <button id="uploadBtn">Subir póliza</button>
    <div id="uploadStatus"></div>
    <div id="uploadError"></div>
  </div>

  <div id="chatWrapper">
    <div class="section-title">2. Consultas sobre la póliza</div>
    <div class="subtitle">
      Escribí tus preguntas sobre coberturas, exclusiones, deducibles, etc.
    </div>

    <div id="noPolicy">Primero subí una póliza para activar el chat.</div>

    <div id="chat"></div>

    <div class="row">
      <textarea id="input" rows="2" placeholder="Ejemplo: ¿Cuál es el deducible por robo según esta póliza?"></textarea>
      <button id="send">Enviar</button>
    </div>
  </div>
</div>

<script>
  const fileInput = document.getElementById('fileInput');
  const uploadBtn = document.getElementById('uploadBtn');
  const uploadStatus = document.getElementById('uploadStatus');
  const uploadError = document.getElementById('uploadError');
  const chat = document.getElementById('chat');
  const input = document.getElementById('input');
  const sendBtn = document.getElementById('send');
  const noPolicy = document.getElementById('noPolicy');

  let policyId = null;

  function addMessage(text, type) {
    const div = document.createElement('div');
    div.className = 'msg ' + type;
    div.textContent = text;
    chat.appendChild(div);
    chat.scrollTop = chat.scrollHeight;
  }

  async function uploadPolicy() {
    uploadStatus.textContent = '';
    uploadError.textContent = '';
    noPolicy.style.display = 'none';

    const file = fileInput.files[0];
    if (!file) {
      uploadError.textContent = 'Seleccioná un archivo antes de subir.';
      return;
    }

    uploadBtn.disabled = true;

    // DEMO: solo simula que se sube correctamente
    setTimeout(() => {
      policyId = 'demo-policy-id';
      uploadStatus.textContent = 'Póliza subida correctamente. Chat activado.';
      uploadBtn.disabled = false;
    }, 600);
  }

  async function sendMessage() {
    if (!policyId) {
      noPolicy.style.display = 'block';
      return;
    }

    const text = input.value.trim();
    if (!text) return;

    addMessage(text, 'user');
    input.value = '';
    sendBtn.disabled = true;

    // DEMO: respuesta fija simulando IA
    setTimeout(() => {
      addMessage('Esta es una respuesta de ejemplo basada en tu póliza. Aquí iría la lógica real del modelo.', 'bot');
      sendBtn.disabled = false;
    }, 600);
  }

  uploadBtn.addEventListener('click', uploadPolicy);
  sendBtn.addEventListener('click', sendMessage);
  input.addEventListener('keydown', (e) => {
    if (e.key === 'Enter' && !e.shiftKey) {
      e.preventDefault();
      sendMessage();
    }
  });
</script>
</body>
</html>
